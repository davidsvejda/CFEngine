bundle agent os_hardening
{
  vars:
    any::
      "file"				string => "/etc/ssh/sshd_config";
      "sshd_config[Protocol]" 		string => "2";
      "sshd_config[PermitRootLogin]" 	string => "no";
      "sshd_config[LogLevel]" 		string => "DEBUG";

  files:
    any::
      "$(file)"
	perms => mog("0640", "root", "root"),      
        edit_line => set_config_values("sshd_config");

  reports:
   '$(this.bundle) modify: "$(file)"';
}

